import{preloadImages}from"../../libs/utils.js";import{swiperSong,swiperTickets,scrollToSection,animation,scrollToTop}from"../../js/index/global.js";$=jQuery;let lenis=new Lenis;function getParam(e){return new URL(window.location.href).searchParams.get(e)||"N/A"}function formRegister(){let l=document.getElementById("form-register");if(l){let i=l.querySelector("button[type='submit']"),o=l.querySelector("#accept"),s=l.querySelectorAll(".field-item input"),r=document.querySelector(".message-success");l.querySelector('[name="utm_source"]').value=getParam("utm_source"),l.querySelector('[name="utm_medium"]').value=getParam("utm_medium"),i.disabled=!0,o.addEventListener("change",function(){i.disabled=!this.checked}),l.addEventListener("submit",function(e){e.preventDefault();let t=!0;l.querySelectorAll(".field-item").forEach(e=>e.classList.remove("error")),s.forEach(e=>{"checkbox"!==e.type&&""===e.value.trim()&&(e.closest(".field-item").classList.add("error"),t=!1)}),o.checked||(o.closest(".field-item").classList.add("error"),t=!1),t&&(i.classList.add("aloading"),e=new FormData(l),fetch("https://script.google.com/macros/s/AKfycbzJSGh6G7qgh1TkXOkqoXuNJz0M7inCU5n9aD1pmAaAoBqJmxrrXtT3fvKKcOpoMGia/exec",{method:"POST",body:e}).then(e=>e.json()).then(e=>{i.classList.remove("aloading"),"success"===e.status&&(l.reset(),i.disabled=!0,r)&&(r.style.display="block",setTimeout(()=>{r.style.display="none"},1e4))}).catch(()=>{i.classList.remove("aloading")}))})}}function toggleMobileMenu(){if(document.querySelector(".header-hambuger")){var i=document.querySelector(".header-hambuger");let e=document.querySelector(".header-menu"),t=document.querySelector("body");i.addEventListener("click",function(){console.log("click"),this.classList.toggle("active"),e.classList.toggle("active"),t.classList.toggle("overflow-hidden")})}}lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0);let init=()=>{gsap.registerPlugin(ScrollTrigger),animation(),formRegister(),swiperSong(),swiperTickets(),scrollToSection(),toggleMobileMenu(),scrollToTop()},isLinkClicked=(preloadImages("img").then(()=>{init()}),!1);$("a").on("click",function(e){!this.href||this.href.match(/^#/)||this.href.match(/^javascript:/)||(isLinkClicked=!0)}),$(window).on("beforeunload",function(){isLinkClicked||$(window).scrollTop(0),isLinkClicked=!1});