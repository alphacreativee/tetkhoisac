import{preloadImages}from"../../libs/utils.js";import{swiperSong,swiperTickets,scrollToSection,animation,scrollToTop,countdownTimer,header}from"../../js/index/global.js";$=jQuery;let lenis=new Lenis;function getParam(e){return new URL(window.location.href).searchParams.get(e)||"N/A"}function getReferrer(){return document.referrer&&""!==document.referrer?document.referrer:"direct"}function formRegister(){let l=document.getElementById("form-register");if(l){let r=l.querySelector("button[type='submit']"),i=l.querySelector("#accept"),o=l.querySelectorAll(".field-item input"),s=document.querySelector(".message-success");l.querySelector('[name="utm_source"]').value=getParam("utm_source"),l.querySelector('[name="utm_medium"]').value=getParam("utm_medium"),l.querySelector('[name="ref_link"]').value=getReferrer()||"direct",console.log("ref_link:",getReferrer()),r.disabled=!0,i.addEventListener("change",function(){r.disabled=!this.checked}),l.addEventListener("submit",function(e){e.preventDefault();let t=!0;l.querySelectorAll(".field-item").forEach(e=>e.classList.remove("error")),o.forEach(e=>{"checkbox"!==e.type&&""===e.value.trim()&&(e.closest(".field-item").classList.add("error"),t=!1)}),i.checked||(i.closest(".field-item").classList.add("error"),t=!1),t&&(r.classList.add("aloading"),e=new FormData(l),new URLSearchParams(e),Object.fromEntries(new FormData(l).entries()),fetch("https://script.google.com/macros/s/AKfycbwSqkHjNG-uc6rm4Pfbhtqsd2h3UQCCJwpFfBD-3LW6QSpYCrSdlXalfWrdPIG9Z4I/exec",{method:"POST",body:e}).then(e=>e.json()).then(e=>{r.classList.remove("aloading"),"success"===e.status&&(l.reset(),r.disabled=!0,s)&&(s.style.display="block",setTimeout(()=>{s.style.display="none"},1e4))}).catch(()=>{r.classList.remove("aloading")}))})}}function toggleMobileMenu(){if(document.querySelector(".header-hambuger")){var e=document.querySelector(".header-hambuger");let t=document.querySelector(".header-menu"),r=document.querySelector("body");e.addEventListener("click",function(){var e=this.classList.toggle("active");t.classList.toggle("active"),r.classList.toggle("overflow-hidden"),e?window.lenis&&lenis.stop():window.lenis&&lenis.start()})}}lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0);let init=()=>{gsap.registerPlugin(ScrollTrigger),animation(),formRegister(),swiperSong(),swiperTickets(),scrollToSection(),toggleMobileMenu(),scrollToTop(),header(),countdownTimer()},isLinkClicked=(preloadImages("img").then(()=>{init()}),!1);$("a").on("click",function(e){!this.href||this.href.match(/^#/)||this.href.match(/^javascript:/)||(isLinkClicked=!0)}),$(window).on("beforeunload",function(){isLinkClicked||$(window).scrollTop(0),isLinkClicked=!1});